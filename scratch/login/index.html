<!-- GitHub Pages用HTML -->
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>ログインページ</title>
</head>
<body>
  <h1>ログインページ</h1>
  
  <!-- 認証コード発行ボタン -->
  <button id="generate_code">認証コード発行</button>
  
  <p id="code_display"></p>

  <!-- ユーザーコード入力と送信 -->
  <input type="text" id="user_code" placeholder="認証コードを入力">
  <button id="submit_code">コードを送信</button>
  
  <p id="result"></p>

  <script>
    // 認証コード生成処理
    document.getElementById("generate_code").addEventListener("click", () => {
      const code = Math.random().toString(36).substring(2, 8).toUpperCase(); // ランダムなコード生成
      document.getElementById("code_display").innerText = `認証コード: ${code}`;
      localStorage.setItem("auth_code", code); // GitHub Pages上でコードを保存（次に確認用）
    });

    // コード送信処理
    document.getElementById("submit_code").addEventListener("click", async () => {
      const userCode = document.getElementById("user_code").value;
      const storedCode = localStorage.getItem("auth_code"); // 保存されたコードを取得

      if (userCode === storedCode) {
        // Glitchサーバーに認証コードを送信
        const response = await fetch(`https://your-glitch-app.glitch.me/verify/${userCode}`);
        const data = await response.json();

        if (data.verified) {
          document.getElementById("result").innerText = "ログイン成功！";
          // ユーザー名とアイコンを表示（仮の例）
          document.getElementById("result").innerHTML += `<br>ユーザー名: ユーザー名例<br><img src="https://example.com/avatar.jpg" alt="アイコン">`;
        } else {
          document.getElementById("result").innerText = "認証失敗";
        }
      } else {
        document.getElementById("result").innerText = "コードが間違っています";
      }
    });
  </script>
</body>
</html>
